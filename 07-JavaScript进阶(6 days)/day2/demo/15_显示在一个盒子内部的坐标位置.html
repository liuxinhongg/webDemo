<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>Document</title>
	<style type="text/css">
		div{
			width: 400px;
			height: 400px;
			background-color: yellowgreen;
			margin: 100px;
		}
	</style>
</head>
<body>
	<div></div>

	<script type="text/javascript">
		var oDiv = document.getElementsByTagName("div")[0];

		oDiv.onmousemove = function(event){
			event = event || window.event;
			// offsetX、offsetY直接得到坐标值，曾经不兼容
			// var x = event.offsetX;
			// var y = event.offsetY;
			
			//周转一下
			var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;

			var x = event.clientX - (getAllLeft(oDiv));
			var y = event.clientY - (getAllTop(oDiv) - scrollTop);

			oDiv.innerHTML =  x + " " + y;
		}


		//返回这个元素在页面中的净位置
		//就是这个元素所有offsetParent的offsetTop值的和
 		function getAllTop(obj){
 			//累加器，累加器的初始值不是0，而是自己现在offsetTop值
 			//一会儿while语句直接从它爸开始了
 			var allTop = obj.offsetTop;
 			//当前正在算高度的元素
 			var currentObj = obj;
 			while(currentObj = currentObj.offsetParent){
 				allTop += currentObj.offsetTop;
 			}
 			return allTop;
 		}

 		function getAllLeft(obj){
 			//累加器，累加器的初始值不是0，而是自己现在offsetTop值
 			//一会儿while语句直接从它爸开始了
 			var allLeft = obj.offsetLeft;
 			//当前正在算高度的元素
 			var currentObj = obj;
 			while(currentObj = currentObj.offsetParent){
 				allLeft += currentObj.offsetLeft;
 			}
 			return allLeft;
 		}
	</script>
</body>
</html>